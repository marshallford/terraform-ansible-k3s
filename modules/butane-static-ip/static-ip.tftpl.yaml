variant: fcos
version: 1.5.0
storage:
  files:
  - path: /etc/NetworkManager/conf.d/noauto.conf
    mode: 0600
    overwrite: true
    contents:
      inline: |
        [main]
        no-auto-default=*
  - path: /etc/NetworkManager/system-connections/${interface}.nmconnection
    mode: 0600
    overwrite: true
    contents:
      inline: |
        [connection]
        id=${interface}
        type=ethernet
        interface-name=${interface}
        [ipv4]
        address1=${ip}/${prefix}
        %{~ if gateway != null ~}
        gateway=${gateway}
        %{~ endif ~}
        dns=${join(";", nameservers)};
        dns-search=${join(";", search_domains)};
        %{~ for index, route in static_routes ~}
        route${index+1}=${join(",", compact(["${route.address}/${route.prefix}", route.gateway, route.metric]))}
        %{~ endfor ~}
        may-fail=false
        method=manual
